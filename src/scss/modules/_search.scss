@use "sass:math";
@use "../abstracts/functions" as f;
@use "../abstracts/mixins" as m;
@use "../abstracts/variables" as v;

.search {
	position: relative;

	&__label {
		&::before,
		&::after {
			display: none;
		}
	}
}

.search-form {
	position: relative;

	&__btn {
		background: linear-gradient(
				to right,
				transparent 0 33.3%,
				f.cssvar(color-primary-light) 33.3% 66.6%,
				f.cssvar(color-primary-dark) 66.6% 100%
			)
			0% 0% / 300% 100% no-repeat;
		border: none;
		box-shadow: none;
		padding: 0 f.cssvar(spacing-3xs);
		position: absolute;
		top: 0;
		right: 0;
		bottom: 0;
		transform: none;
		transition: all 0.4s ease-in-out 0s;

		&--icon {
			display: flex;
			align-items: center;

			svg {
				fill: f.cssvar(color-primary);
				width: f.pxtorem(30);
				transition: all 0.3s ease-in 0s;
			}
		}

		&--txt {
			display: none;
		}

		&:hover,
		&:focus {
			background-position: 50% 0;
			box-shadow: none;

			svg {
				fill: f.cssvar(color-fg-inverted);
				transform: rotate(360deg);
			}
		}

		&:active {
			background-position: 100% 0;
			border: none;
			box-shadow: none;
			transform: none;
		}
	}

	&__field {
		&:hover {
			~ .search-form__btn {
				transform: translateX(#{f.pxtorem(-3)})
					translateY(#{f.pxtorem(-3)});
			}
		}

		&:focus {
			~ .search-form__btn {
				transform: translateX(#{f.pxtorem(2)})
					translateY(#{f.pxtorem(2)});
			}
		}
	}
}

.page__body {
	.search-form {
		margin-bottom: f.cssvar(spacing-md);
	}
}

.search__checkbox {
	cursor: pointer;
	opacity: 0;
	z-index: 2;
	position: absolute;
	top: f.pxtorem(
		math.div(40, 2) - 8
	); // label height/2 - approximate checkbox height
	right: f.pxtorem(
		math.div(40, 2) - 8
	); // label width/2 - approximate checkbox width;

	&:hover,
	&:focus {
		~ .search__label {
			background-position: 0 50%;
		}
	}

	&:focus {
		~ .search__label {
			outline: f.cssvar(color-primary) dotted f.pxtorem(1);
		}
	}

	&:not(:checked) {
		~ .search-form {
			display: none;
		}
	}
}

.search__checkbox:checked {
	~ .search__label {
		background-position: 0 100%;
		z-index: 5;

		.search__icon {
			position: relative;

			&::before {
				display: block;
				content: "";
				background-image: url(#{f.encodesvg('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" style="stroke: #{v.$color_catskill-white}; stroke-width: 5; stroke-linecap: round;"><path d="M 10,10 90.00004,90.00004 M 90.00004,10 10,90.00004" id="path2" style="stroke-width:20" /></svg>')});
				width: 100%;
				height: 100%;
				position: absolute;
				top: 0;
				left: 0;
				animation: scaleFullWidth 0.5s;
			}
		}

		svg {
			display: none;
		}
	}

	~ .search-form {
		display: flex;
		align-items: center;
		justify-content: center;
		flex-flow: column wrap;
	}

	&:hover,
	&:focus {
		~ .search__label {
			background-position: 0 50%;
		}
	}
}

[data-color-scheme="dark"] {
	.search__checkbox {
		&:checked {
			~ .search__label {
				.search__icon {
					&::before {
						display: block;
						content: "";
						background-image: url(#{f.encodesvg('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" style="stroke: #{v.$color_firefly}; stroke-width: 5; stroke-linecap: round;"><path d="M 10,10 90.00004,90.00004 M 90.00004,10 10,90.00004" id="path2" style="stroke-width:20" /></svg>')});
					}
				}
			}
		}
	}
}
